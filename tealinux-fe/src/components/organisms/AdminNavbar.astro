---
import Button from "../atoms/Button.astro";
---

<nav class="bg-slate-800 border-b border-slate-700 p-4 flex justify-between items-center">
  <div class="text-white font-medium">Admin Panel</div>
  <div class="flex gap-2 items-center">
    <span id="admin-name" class="text-sm text-slate-400 mr-2"></span>
    <Button variant="default">Profile</Button>
    <Button variant="danger" id="logout-btn">Logout</Button>
  </div>
</nav>

<script is:inline>
  {
      document.getElementById('logout-btn')?.addEventListener('click', () => {
          localStorage.removeItem('access_token');
          localStorage.removeItem('refresh_token');
          window.location.href = '/login';
      });

      // Fetch admin profile
      const token = localStorage.getItem('access_token');
      if(token) {
          fetch('http://localhost:3000/api/me', {
              headers: { 'Authorization': `Bearer ${token}` }
          })
          .then(res => res.json())
          .then(data => {
              if(data.Name) {
                  document.getElementById('admin-name').textContent = data.Name;
              }
          })
          .catch(console.error);
      }
  }
</script>
