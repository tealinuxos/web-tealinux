---
interface Props {
  isFixed?: boolean;
}
const { isFixed = true } = Astro.props;
const wrapperClass = isFixed 
  ? "fixed top-0 left-0 right-0 z-50 pt-[20px] pb-[10px]" 
  : "pt-[20px] pb-[10px]";
---
<div class={wrapperClass}>
    <nav class="flex justify-between items-center w-[90%] max-w-[910px] h-[70px] px-6 md:px-9 py-2.5 rounded-[50px] border-[5px] border-white/30 bg-[linear-gradient(116deg,rgba(255,255,255,0.40)_2.89%,rgba(255,255,255,0.10)_69.08%)] backdrop-blur-[20px] mx-auto transition-all duration-300">
    <a href="/" class="flex items-center text-white hover:opacity-90 transition-opacity">
        <svg width="177" height="54" viewBox="0 0 177 54" fill="none" xmlns="http://www.w3.org/2000/svg" class="h-8 md:h-10 w-auto">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M19.9408 48.2576C18.9344 44.2819 16.8308 42.8463 8.59837 36.9934C0.365891 31.1406 0 12.9192 0 12.9192C0 12.9192 5.12243 19.4348 10.4278 21.4226C15.7332 23.4104 19.6664 29.0423 20.0323 32.4657L19.9449 18.7722C19.9449 18.7722 20.4931 13.8028 24.1526 11.7045C27.8115 9.6063 31.1044 6.73516 31.6532 4.41599C31.6532 4.41599 33.2083 13.5819 29.7324 17.9991C26.2564 22.4164 21.4999 23.5207 21.0426 26.0607L20.9552 54L20.0399 53.8945L19.9408 48.2576Z" fill="currentColor"/>
            <path fill-rule="evenodd" clip-rule="evenodd" d="M16.9643 14.4666C16.9643 14.4666 17.879 14.0249 14.8605 10.7119C11.842 7.39895 14.5861 0 14.5861 0C14.5861 0 15.2264 2.20872 16.69 3.86518C18.1535 5.52163 19.8914 10.1598 16.9643 14.4666Z" fill="currentColor"/>
            <path d="M46.108 27.152V30.44H41.644V44H37.54V30.44H33.076V27.152H46.108ZM60.7917 37.088C60.7917 37.472 60.7677 37.872 60.7197 38.288H51.4317C51.4957 39.12 51.7597 39.76 52.2237 40.208C52.7037 40.64 53.2877 40.856 53.9757 40.856C54.9997 40.856 55.7117 40.424 56.1117 39.56H60.4797C60.2557 40.44 59.8477 41.232 59.2557 41.936C58.6797 42.64 57.9517 43.192 57.0717 43.592C56.1917 43.992 55.2077 44.192 54.1197 44.192C52.8077 44.192 51.6397 43.912 50.6157 43.352C49.5917 42.792 48.7917 41.992 48.2157 40.952C47.6397 39.912 47.3517 38.696 47.3517 37.304C47.3517 35.912 47.6317 34.696 48.1917 33.656C48.7677 32.616 49.5677 31.816 50.5917 31.256C51.6157 30.696 52.7917 30.416 54.1117 30.416C55.4157 30.416 56.5677 30.688 57.5757 31.232C58.5837 31.776 59.3677 32.552 59.9277 33.56C60.5037 34.568 60.7917 35.744 60.7917 37.088ZM56.5917 36.008C56.5917 35.304 56.3517 34.744 55.8717 34.328C55.3917 33.912 54.7917 33.704 54.0717 33.704C53.3837 33.704 52.7997 33.904 52.3197 34.304C51.8557 34.704 51.5677 35.272 51.4557 36.008H56.5917ZM62.1408 37.28C62.1408 35.904 62.3968 34.696 62.9088 33.656C63.4368 32.616 64.1488 31.816 65.0448 31.256C65.9408 30.696 66.9408 30.416 68.0448 30.416C68.9888 30.416 69.8128 30.608 70.5168 30.992C71.2368 31.376 71.7888 31.88 72.1728 32.504V30.608H76.2768V44H72.1728V42.104C71.7728 42.728 71.2128 43.232 70.4928 43.616C69.7888 44 68.9648 44.192 68.0208 44.192C66.9328 44.192 65.9408 43.912 65.0448 43.352C64.1488 42.776 63.4368 41.968 62.9088 40.928C62.3968 39.872 62.1408 38.656 62.1408 37.28ZM72.1728 37.304C72.1728 36.28 71.8848 35.472 71.3088 34.88C70.7488 34.288 70.0608 33.992 69.2448 33.992C68.4288 33.992 67.7328 34.288 67.1568 34.88C66.5968 35.456 66.3168 36.256 66.3168 37.28C66.3168 38.304 66.5968 39.12 67.1568 39.728C67.7328 40.32 68.4288 40.616 69.2448 40.616C70.0608 40.616 70.7488 40.32 71.3088 39.728C71.8848 39.136 72.1728 38.328 72.1728 37.304ZM83.3498 40.832H88.7258V44H79.2458V27.152H83.3498V40.832ZM92.7473 29.216C92.0273 29.216 91.4353 29.008 90.9713 28.592C90.5233 28.16 90.2993 27.632 90.2993 27.008C90.2993 26.368 90.5233 25.84 90.9713 25.424C91.4353 24.992 92.0273 24.776 92.7473 24.776C93.4513 24.776 94.0273 24.992 94.4753 25.424C94.9393 25.84 95.1713 26.368 95.1713 27.008C95.1713 27.632 94.9393 28.16 94.4753 28.592C94.0273 29.008 93.4513 29.216 92.7473 29.216ZM94.7873 30.608V44H90.6833V30.608H94.7873ZM105.921 30.464C107.489 30.464 108.737 30.976 109.665 32C110.609 33.008 111.081 34.4 111.081 36.176V44H107.001V36.728C107.001 35.832 106.769 35.136 106.305 34.64C105.841 34.144 105.217 33.896 104.433 33.896C103.649 33.896 103.025 34.144 102.561 34.64C102.097 35.136 101.865 35.832 101.865 36.728V44H97.7614V30.608H101.865V32.384C102.281 31.792 102.841 31.328 103.545 30.992C104.249 30.64 105.041 30.464 105.921 30.464ZM127.157 30.608V44H123.053V42.176C122.637 42.768 122.069 43.248 121.349 43.616C120.645 43.968 119.861 44.144 118.997 44.144C117.973 44.144 117.069 43.92 116.285 43.472C115.501 43.008 114.893 42.344 114.461 41.48C114.029 40.616 113.813 39.6 113.813 38.432V30.608H117.893V37.88C117.893 38.776 118.125 39.472 118.589 39.968C119.053 40.464 119.677 40.712 120.461 40.712C121.261 40.712 121.893 40.464 122.357 39.968C122.821 39.472 123.053 38.776 123.053 37.88V30.608H127.157ZM138.025 44L135.457 40.28L133.297 44H128.857L133.273 37.16L128.737 30.608H133.345L135.913 34.304L138.073 30.608H142.513L138.025 37.352L142.633 44H138.025ZM152.183 44.168C150.599 44.168 149.143 43.8 147.815 43.064C146.503 42.328 145.455 41.304 144.671 39.992C143.903 38.664 143.519 37.176 143.519 35.528C143.519 33.88 143.903 32.4 144.671 31.088C145.455 29.776 146.503 28.752 147.815 28.016C149.143 27.28 150.599 26.912 152.183 26.912C153.767 26.912 155.215 27.28 156.527 28.016C157.855 28.752 158.895 29.776 159.647 31.088C160.415 32.4 160.799 33.88 160.799 35.528C160.799 37.176 160.415 38.664 159.647 39.992C158.879 41.304 157.839 42.328 156.527 43.064C155.215 43.8 153.767 44.168 152.183 44.168ZM152.183 40.424C153.527 40.424 154.599 39.976 155.399 39.08C156.215 38.184 156.623 37 156.623 35.528C156.623 34.04 156.215 32.856 155.399 31.976C154.599 31.08 153.527 30.632 152.183 30.632C150.823 30.632 149.735 31.072 148.919 31.952C148.119 32.832 147.719 34.024 147.719 35.528C147.719 37.016 148.119 38.208 148.919 39.104C149.735 39.984 150.823 40.424 152.183 40.424ZM169.178 44.168C167.946 44.168 166.842 43.968 165.866 43.568C164.89 43.168 164.106 42.576 163.514 41.792C162.938 41.008 162.634 40.064 162.602 38.96H166.97C167.034 39.584 167.25 40.064 167.618 40.4C167.986 40.72 168.466 40.88 169.058 40.88C169.666 40.88 170.146 40.744 170.498 40.472C170.85 40.184 171.026 39.792 171.026 39.296C171.026 38.88 170.882 38.536 170.594 38.264C170.322 37.992 169.978 37.768 169.562 37.592C169.162 37.416 168.586 37.216 167.834 36.992C166.746 36.656 165.858 36.32 165.17 35.984C164.482 35.648 163.89 35.152 163.394 34.496C162.898 33.84 162.65 32.984 162.65 31.928C162.65 30.36 163.218 29.136 164.354 28.256C165.49 27.36 166.97 26.912 168.794 26.912C170.65 26.912 172.146 27.36 173.282 28.256C174.418 29.136 175.026 30.368 175.106 31.952H170.666C170.634 31.408 170.434 30.984 170.066 30.68C169.698 30.36 169.226 30.2 168.65 30.2C168.154 30.2 167.754 30.336 167.45 30.608C167.146 30.864 166.994 31.24 166.994 31.736C166.994 32.28 167.25 32.704 167.762 33.008C168.274 33.312 169.074 33.64 170.162 33.992C171.25 34.36 172.13 34.712 172.802 35.048C173.49 35.384 174.082 35.872 174.578 36.512C175.074 37.152 175.322 37.976 175.322 38.984C175.322 39.944 175.074 40.816 174.578 41.6C174.098 42.384 173.394 43.008 172.466 43.472C171.538 43.936 170.442 44.168 169.178 44.168Z" fill="currentColor"/>
        </svg>
    </a>

    <!-- Desktop Menu -->
    <div class="hidden md:flex gap-5 items-center">
        <a href="/" class="text-white/90 hover:text-white hover:text-shadow-glow transition-all text-sm font-medium">Home</a>
        <a href="/download" class="text-white/90 hover:text-white hover:text-shadow-glow transition-all text-sm font-medium">Download</a>
        <a href="/docs" class="text-white/90 hover:text-white hover:text-shadow-glow transition-all text-sm font-medium">Docs</a>
        <a href="/about" class="text-white/90 hover:text-white hover:text-shadow-glow transition-all text-sm font-medium">About</a>
        <a href="/forum" class="text-white/90 hover:text-white hover:text-shadow-glow transition-all text-sm font-medium">Forum</a>
        

   
    </div>

    <!-- Mobile Menu Button -->
    <button id="mobileMenuBtn" class="md:hidden text-white focus:outline-none">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
    </button>
</nav>

<!-- Mobile Menu Dropdown -->
<div id="mobileMenu" class="hidden fixed inset-x-0 top-[100px] mx-auto w-[90%] max-w-[910px] p-4 rounded-2xl border border-white/20 bg-slate-900/90 backdrop-blur-xl z-40 flex-col gap-4 md:hidden">
    <a href="/" class="text-white/90 hover:text-white py-2 border-b border-white/10">Home</a>
    <a href="/download" class="text-white/90 hover:text-white py-2 border-b border-white/10">Download</a>
    <a href="/docs" class="text-white/90 hover:text-white py-2 border-b border-white/10">Docs</a>
    <a href="/about" class="text-white/90 hover:text-white py-2 border-b border-white/10">About</a>
    <a href="/forum" class="text-white/90 hover:text-white py-2 border-b border-white/10">Forum</a>



</div>

<script>
	import { isAuthenticated, getCurrentUser, clearAuthData } from '../../lib/auth';

	const navLinksDesktop = document.getElementById('navLinksDesktop');
	const userProfileDesktop = document.getElementById('userProfileDesktop');
	const userNameDesktop = document.getElementById('userNameDesktop');
	const logoutBtnDesktop = document.getElementById('logoutBtnDesktop');

    const navLinksMobile = document.getElementById('navLinksMobile');
	const userProfileMobile = document.getElementById('userProfileMobile');
	const userNameMobile = document.getElementById('userNameMobile');
	const logoutBtnMobile = document.getElementById('logoutBtnMobile');

    const mobileMenuBtn = document.getElementById('mobileMenuBtn');
    const mobileMenu = document.getElementById('mobileMenu');

    mobileMenuBtn?.addEventListener('click', () => {
        mobileMenu?.classList.toggle('hidden');
        mobileMenu?.classList.toggle('flex');
    });

	function checkAuth() {
		if (!isAuthenticated()) return;

		const user = getCurrentUser();
		if (!user) return;
		
		// Desktop updates
		if (navLinksDesktop) navLinksDesktop.style.display = 'none';
		if (userProfileDesktop) {
			userProfileDesktop.classList.remove('hidden');
			userProfileDesktop.classList.add('flex');
		}
		if (userNameDesktop) userNameDesktop.textContent = user.name;

		// Mobile updates
		if (navLinksMobile) navLinksMobile.style.display = 'none';
		if (userProfileMobile) {
			userProfileMobile.classList.remove('hidden');
			userProfileMobile.classList.add('flex');
		}
		if (userNameMobile) userNameMobile.textContent = user.name;
	}

    const handleLogout = () => {
		clearAuthData();
		window.location.reload();
	};

	logoutBtnDesktop?.addEventListener('click', handleLogout);
    logoutBtnMobile?.addEventListener('click', handleLogout);

	checkAuth();
</script>

<style>
    /* Custom utility for text glow if not in Tailwind config */
    .hover\:text-shadow-glow:hover {
        text-shadow: 0 0 10px #07b14e;
    }
</style>
